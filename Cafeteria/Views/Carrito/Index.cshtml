@model List<Cafeteria.Models.CarritoItem>

@{
    ViewBag.Title = "Carrito";
}

<h2>Carrito de Compras</h2>

@if (!Model.Any())
{
    <p>El carrito está vacío.</p>
    <a href="@Url.Action("Index", "Catalogo")" class="btn btn-primary">Volver</a>
}
else
{
    <div class="row">
        @foreach (var item in Model)
        {
            <div class="col-md-4 col-sm-6 col-12 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h5 class="card-title">@item.Nombre</h5>
                        <p class="card-text">
                            <strong>Ingredientes:</strong> @item.Ingredientes<br />
                            <strong>Precio:</strong> ₡@item.Precio
                        </p>
                        <a href="@Url.Action("Eliminar", "Carrito", new { id = item.IdProducto })" class="btn btn-danger">Eliminar</a>
                    </div>
                </div>
            </div>
        }
    </div>

    <hr />
    <h4>Total de la orden: <strong>₡@Model.Sum(p => p.Precio)</strong></h4>

    using (Html.BeginForm("FinalizarPedido", "Carrito", FormMethod.Post))
    {
        <div class="form-group">
            <label for="nombreCliente">Nombre del Cliente:</label>
            <input type="text" id="nombreCliente" name="nombreCliente" class="form-control" list="clientes" required />
            <datalist id="clientes">
                @foreach (var cliente in ViewBag.Clientes as List<Cafeteria.ClientesCafeteria>)
                {
                    <option value="@cliente.Nombre" />
                }
            </datalist>
        </div>

        <div class="form-group mt-3">
            <label for="metodoPago">Método de Pago:</label>
            <select id="metodoPago" name="metodoPago" class="form-control" required>
                <option value="Efectivo">Efectivo</option>
                <option value="SINPE">SINPE</option>
            </select>
        </div>

        <button type="submit" class="btn btn-success mt-4">Finalizar Orden</button>
    }

    <a href="@Url.Action("Index", "Catalogo")" class="btn btn-primary mt-2">Seguir comprando</a>
}
